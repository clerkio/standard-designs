<script type="text/javascript">
  (function (w, d) {
    var e = d.createElement('script'); e.type = 'text/javascript'; e.async = true;
    e.src = (d.location.protocol == 'https:' ? 'https' : 'http') + '://cdn.clerk.io/clerk.js';
    var s = d.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
    w.__clerk_q = w.__clerk_q || []; w.Clerk = w.Clerk || function () { w.__clerk_q.push(arguments) };
  })(window, document);

  let publicKey = "INSERT_KEY_HERE";
  Clerk('config', {
    key: publicKey,
  });

  document.addEventListener('DOMContentLoaded', (e) => {
	;(async function fetchVisitorId() {
		try {
			const response = await fetch(`https://api.clerk.io/v2/misc/visitor_id?key=${publicKey}&visitor=auto`)
			const data = await response.json()
			visitorId = data.visitor
			Clerk('config', {
				visitor: visitorId,
			})
		} catch (error) {
			console.error('Error:', error)
		} finally {
			window.Shopify.analytics.publish('clerk_pixel_context', {
				localeApiKey: publicKey,
				visitor: visitorId,
			})
		}
	})()
})
</script>